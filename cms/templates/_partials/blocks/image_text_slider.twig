{# Image/Text Slider Block #}
{% set block_type = "image_text_slider" %}

{# Macro Imports #}
{% import '_macros/lazyImager' as LazyImager %}

{# Block variable defaults #}
{% set heading = block['heading'] is defined ? block.heading : '' %}
{% set subheading = block['subheading'] is defined ? block.subheading : '' %}
{% set rtfContent = block['rtfContent'] is defined ? block.rtfContent : '' %}
{% set sectionType = block['sectionType'] is defined ? block.sectionType : 'standard' %}
{% set items = block.children is defined ? block.children|filter(item => item.type.handle == 'imageTextSliderItem') : null %}

<section class="section section--dark section-{{ block_type }}--block section--{{ sectionType }} animatable">
    <div class="content-container">
        <div class="text-container">
            <div class="container container--full">
                <div class="text-content">
                    {% if subheading|length %}
                        <p class="subtitle--heading">{{ subheading }}</p>
                    {% endif %}
                    {% if heading|length %}
                        <h2 class="primary--heading">{{ heading }}</h2>
                    {% endif %}
                    {% if rtfContent|length %}
                        <div class="content rte">
                            {{ rtfContent }}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="navigation-container">
            <div class="slider-navigation">
                {% for item in items %}
                <div class="slider-navigation-item{% if loop.first %} active{% endif %}" data-slide-index="{{ loop.index0 }}">
                    <div class="nav-text-container">
                        {{ item.shortTitle }}
                        <div class="icon-container"><span class="icon" data-feather="chevron-right"></span></div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="slides-container">
        <div class="swiper-container">
            <div class="swiper-wrapper">
                {% for item in items %}
                    {% set image = item['image'] is defined ? item.image.one() : null %}
                    {% set buttons = item.children.all() %}
                    {% if image %}
                        {% set imageOptions = {
                        sizes: [
                            { width: 2200 },
                            { width: 1920 },
                            { width: 1366 },
                            { width: 768 },
                            { width: 360 },
                        ],
                        alt: image.title,
                        cover: true,
                        wrapImage: false,
                        } %}
                    {% endif %}
                    <div class="slide-wrapper swiper-slide">
                        <div class="slide">
                            <div class="image-container">{% if image|length %}{{ LazyImager.LazyImager(image, imageOptions) }}{% endif %}</div>
                            <div class="caption-container">
                                {% if item.heading|length %}<p class="inline--heading">{{ item.heading }}</p>{% endif %}
                                {% if item.rtfContent|length %}<div class="content rte">{{ item.rtfContent }}</div>{% endif %}
                                {% if buttons and buttons|length %}
                                    <div class="buttons">
                                        {% for button in buttons %}
                                        {% include "_partials/snippets/button" with {
                                            title: button.linkField.getText(),
                                            url: button.linkField.getUrl(),
                                            target: button.linkField.getTarget(),
                                            type: button.buttonType,
                                            isLightbox: button.isLightbox
                                        } only %}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
