{# Image/Stats Banner Block #}
{% set block_type = "image_stats_banner" %}

{# Macro Imports #}
{% import '_macros/lazyImager' as LazyImager %}

{# Block variable defaults #}
{% set image = block['image'] is defined ? block.image[0] : null %}
{% set heading = block['heading'] is defined ? block.heading : '' %}
{% set subheading = block['subheading'] is defined ? block.subheading : '' %}
{% set sectionType = block['sectionType'] is defined ? block.sectionType : 'standard' %}
{% set sectionAlignment = block['sectionAlignment'] is defined ? block.sectionAlignment : 'standard' %}
{% set statistics = block.children is defined ? block.children|filter(item => item.type.handle == 'image_stats_banner_statistic') : null %}

{% if image %}
    {% set imageOptions = {
    sizes: [
        { width: 2200 },
        { width: 1920 },
        { width: 1366 },
        { width: 768 },
        { width: 360 },
    ],
    alt: image.title,
    cover: true,
    wrapImage: false,
    } %}
{% endif %}

<section id="permalink-{{ index }}--{{ block.type.handle }}" class="section section--dark section-{{ block_type }}--block section--{{ sectionType }} section-alignment--{{ sectionAlignment }} animatable">
    <div class="image-container">
        {% if image|length %}{{ LazyImager.LazyImager(image, imageOptions) }}{% endif %}
    </div>
    <div class="text-container">
        <div class="container container--full">
            <div class="text-content">
                {% if subheading|length %}
                    <p class="subtitle--heading">{{ subheading }}</p>
                {% endif %}
                {% if heading|length %}
                    <h2 class="primary--heading">{{ heading }}</h2>
                {% endif %}
                {% if statistics and statistics|length %}
                    <div class="statistics--container{% if statistics|length > 2 %} show-as-grid{% endif %}">
                        {% for item in statistics %}
                            {% set statistic = item.heading %}
                            {% set description = item.subheading %}
                            {% set isHighlighted = item.useCustomContent %}

                            <div class="statistic-item">
                                <div class="statistic{% if isHighlighted %} highlighted{% endif %}">
                                    <span class="statistic-text">{{ statistic }}</span>
                                </div>
                                <div class="description">
                                    <p>{{ description }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
